stages:
    train-chess:
        desc: Train PoseNet on chess scene
        cmd: python train.py --config configs/pose_net.yaml --dataset_name chess
            --out models/chess_pose_net.pth --seed 1 --gpu 1 --log_every_n_steps 1
        deps:
            - train.py
            - lieposenet
        outs:
            - models/chess_pose_net.pth.ckpt
        params:
            -   configs/pose_net.yaml:
                - model
                - max_epochs
                - data_module
    test-chess:
        desc: Test Pose Net
        cmd: python eval.py
            --config configs/pose_net.yaml --dataset_name chess --result metrics/chess_metrics.json
            --data_saver_path metrics/chess_trajectories.npy --model models/chess_pose_net.pth.ckpt --seed 1 --gpu 1
            --log_every_n_steps 1
        deps:
            - eval.py
            - lieposenet
            - models/chess_pose_net.pth.ckpt
        params:
            - configs/pose_net.yaml:
                - model
                - data_module
        outs:
            - metrics/chess_trajectories.npy
        metrics:
            - metrics/chess_metrics.json:
                cache: false

    train-fire:
        desc: Train PoseNet on fire scene
        cmd: python train.py --config configs/pose_net.yaml --dataset_name fire
            --out models/fire_pose_net.pth --seed 1 --gpu 1 --log_every_n_steps 1
        deps:
            - train.py
            - lieposenet
        outs:
            - models/fire_pose_net.pth.ckpt
        params:
            -   configs/pose_net.yaml:
                - model
                - max_epochs
                - data_module
    test-fire:
        desc: Test Pose Net
        cmd: python eval.py
            --config configs/pose_net.yaml --dataset_name fire --result metrics/fire_metrics.json
            --data_saver_path metrics/fire_trajectories.npy --model models/fire_pose_net.pth.ckpt --seed 1 --gpu 1
            --log_every_n_steps 1
        deps:
            - eval.py
            - lieposenet
            - models/fire_pose_net.pth.ckpt
        params:
            - configs/pose_net.yaml:
                - model
                - data_module
        outs:
            - metrics/fire_trajectories.npy
        metrics:
            - metrics/fire_metrics.json:
                cache: false

